<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MY GOALS - Auto Save</title>
    <!-- 3rd party libs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>

    <div class="app-container">
        <header>
            <h1 data-translate="my-goals">My Goals</h1>
            
            <div class="toolbar">
                <div class="date-group">
                    <input type="tel" id="dateInput" inputmode="numeric" pattern="[0-9.]*">
                    <button class="btn-update" onclick="generateTracker()" data-translate="go">Go</button>
                </div>

                <div class="icon-btn">
                    <div id="colorPreview"></div>
                    <input type="color" id="colorPicker" value="#10b981" oninput="changeColor(this.value, true)">
                </div>

                <div class="icon-btn" onclick="toggleTheme()">
                    <svg id="themeIcon" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </div>

                <div class="icon-btn" onclick="toggleChartType()">
                    <svg id="chartTypeIcon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6,16.5V10H4.5V16.5H6M10.5,16.5V4.5H9V16.5H10.5M15,16.5V7.5H13.5V16.5H15M19.5,16.5V13.5H18V16.5H19.5M21,2H3A1,1 0 0,0 2,3V18A1,1 0 0,0 3,19H21A1,1 0 0,0 22,18V3A1,1 0 0,0 21,2Z"></path>
                    </svg>
                </div>

                <!-- Language Selector -->
                <div class="language-selector-wrapper">
                    <div id="languageSelector" class="icon-btn">
                        <span class="main-flag">ðŸ‡¬ðŸ‡§</span>
                        <div id="languageDropdown">
                            <span class="lang-option" data-lang="en">ðŸ‡¬ðŸ‡§</span>
                            <span class="lang-option" data-lang="de">ðŸ‡©ðŸ‡ª</span>
                            <span class="lang-option" data-lang="ch">ðŸ‡¨ðŸ‡­</span>
                        </div>
                    </div>
                </div>

                <!-- Firebase Auth Buttons -->
                <div class="icon-btn" id="loginButton" onclick="signInWithGoogle()">
                    <img src="G.jpg" alt="Google Logo" style="width: 18px; height: 18px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none;">
                </div>
                <div class="icon-btn" id="logoutButton" onclick="signOutFirebase()" style="display: none;">
                    <svg viewBox="0 0 24 24" style="width: 18px; height: 18px; position: absolute; top: 50%; left: 50%; transform: translate(calc(-50% + 1px), -50%);">
                        <path fill="currentColor" d="M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.59L17 17L22 12L17 7ZM2 2H12A2 2 0 0 1 14 4V8H12V4H2V20H12V16H14V20A2 2 0 0 1 12 22H2A2 2 0 0 1 0 20V4A2 2 0 0 1 2 2Z"/>
                    </svg>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; margin-top: 10px;">
                <span id="authStatus" data-translate="not-logged-in" style="font-size: 14px; color: var(--text-muted);">Not logged in</span>
                <div id="syncButtons" style="display: none; gap: 10px;">
                    <button class="btn-secondary" id="saveButton" onclick="saveGoalsToFirebase()">
                        <span class="btn-text" data-translate="save-to-cloud">Save to Cloud</span>
                        <div class="spinner"></div>
                    </button>
                    <button class="btn-secondary" id="loadButton" onclick="loadGoalsFromFirebase()">
                        <span class="btn-text" data-translate="load-from-cloud">Load from Cloud</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </div>
        </header>

        <div class="table-wrapper">
            <table id="trackerTable"></table>
        </div>

        <div class="chart-section">
            <canvas id="productivityChart"></canvas>
        </div>

        <div class="footer">
            <span class="quote" data-translate="quote">"Do something today that you'll be proud of tomorrow."</span>
            <span class="separator">â€”</span>
            <span class="author">by Silvan 2025</span>
        </div>
    </div>

    <div id="notification-container"></div>

    <div id="confirmation-modal" class="modal-overlay is-hidden">
        <div class="modal-dialog">
            <p id="confirmation-message"></p>
            <div class="modal-buttons">
                <button id="confirm-yes" class="btn-primary" data-translate="yes">Yes</button>
                <button id="confirm-no" class="btn-secondary" data-translate="no">No</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>